<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Questionnaire BDI-II</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 30px;
      background-color: #54A9AE;
      text-align: center;
      color: #2c3e50;
    }
    h1 {
      text-align: center;
      margin-bottom: 40px;
      font-size: 32px;
      color: #2c3e50;
    }
    .identifiant {
      background: #e0e0e0;
      padding: 15px 25px;
      border-radius: 12px;
      text-align: left;
      max-width: 900px;
      margin: 0 auto 30px;
    }
    .identifiant label {
      font-weight: bold;
    }
    .identifiant input {
      width: 300px;
      padding: 8px;
      margin-top: 5px;
    }
    .question {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 25px 30px;
      margin: 30px auto;
      max-width: 900px;
      text-align: left;
      transition: transform 0.2s ease;
    }
    .question:hover {
      transform: scale(1.01);
    }
    .question p {
      font-weight: bold;
      margin-bottom: 10px;
      font-size: 16px;
    }
    label {
      display: block;
      margin: 5px 0;
      cursor: pointer;
      font-size: 15px;
    }
    input[type="radio"] {
      margin-right: 6px;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 30px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
  </style>
</head>
<body>
  <h1>Questionnaire BDI-II</h1>

  <div class="identifiant">
    <label for="identifiant">Identifiant Patient :</label>
    <input type="text" id="identifiant" name="identifiant" placeholder="Ex : ABC456">
  </div>

  <p>Ce questionnaire comporte 21 groupes d'énoncés. Veuillez lire avec soin chacun de ces groupes puis, dans chaque groupe, choisissez l'énoncé qui décrit le mieux comment vous vous êtes senti(e) au cours des deux dernières semaines, incluant aujourd'hui.</p>

  <form id="bdiForm">
    <div id="questions"></div>
    <button type="button" onclick="generateCSV()">Télécharger en CSV</button>
  </form>

  <script>
    const questions = [
      ["Tristesse", ["Je ne me sens pas triste.", "Je me sens très souvent triste.", "Je suis tout le temps triste.", "Je suis si triste ou si malheureux(se) que ce n'est pas supportable."]],
      ["Pessimisme", ["Je ne suis pas découragé(e) face à mon avenir.", "Je me sens plus découragé(e) qu'avant face à mon avenir.", "Je ne m'attends pas à ce que les choses s'arrangent pour moi.", "J'ai le sentiment que mon avenir est sans espoir et qu'il ne peut qu'empirer."]],
      ["Échecs dans le passé", ["Je n'ai pas le sentiment d'avoir échoué dans la vie, d'être un(e) raté(e).", "J'ai échoué plus souvent que je n'aurais dû.", "Quand je pense à mon passé, je constate un grand nombre d'échecs.", "J'ai le sentiment d'avoir complètement raté ma vie."]],
      ["Perte de plaisir", ["J'éprouve toujours autant de plaisir qu'avant aux choses qui me plaisent.", "Je n'éprouve pas autant de plaisir aux choses qu'avant.", "J'éprouve très peu de plaisir aux choses qui me plaisaient habituellement.", "Je n'éprouve aucun plaisir aux choses qui me plaisaient habituellement."]],
      ["Sentiments de culpabilité", ["Je ne me sens pas particulièrement coupable.", "Je me sens coupable pour bien des choses que j'ai faites ou que j'aurais dû faire.", "Je me sens coupable la plupart du temps.", "Je me sens tout le temps coupable."]],
      ["Sentiment d'être puni(e)", ["Je n'ai pas le sentiment d'être puni(e).", "Je sens que je pourrais être puni(e).", "Je m'attends à être puni(e).", "J'ai le sentiment d'être puni(e)."]],
      ["Sentiments négatifs envers soi-même", ["Mes sentiments envers moi-même n'ont pas changé.", "J'ai perdu confiance en moi.", "Je suis déçu(e) par moi-même.", "Je ne m'aime pas du tout."]],
      ["Attitude critique envers soi", ["Je ne me blâme pas ou ne me critique pas plus que d'habitude.", "Je suis plus critique envers moi-même que je ne l'étais.", "Je me reproche tous mes défauts.", "Je me reproche tous les malheurs qui arrivent."]],
      ["Pensées ou désirs de suicide", ["Je ne pense pas du tout à me suicider.", "Il m'arrive de penser à me suicider, mais je ne le ferai pas.", "J'aimerais me suicider.", "Je me suiciderais si l'occasion se présentait."]],
      ["Pleurs", ["Je ne pleure pas plus qu'avant.", "Je pleure plus qu'avant.", "Je pleure pour la moindre petite chose.", "Je voudrais pleurer mais je ne suis pas capable."]],
      ["Agitation", ["Je ne suis pas plus agité(e) ou plus tendu(e) que d'habitude.", "Je me sens plus agité(e) ou tendu(e) que d'habitude.", "Je suis si agité(e) ou tendu(e) que j'ai du mal à rester tranquille.", "Je suis si agité(e) ou tendu(e) que je dois continuellement bouger ou faire quelque chose."]],
      ["Perte d'intérêt", ["Je n'ai pas perdu d'intérêt pour les gens ou pour les activités.", "Je m'intéresse moins qu'avant aux gens et aux choses.", "Je ne m'intéresse presque plus aux gens et aux choses.", "J'ai du mal à m'intéresser à quoique ce soit."]],
      ["Indécision", ["Je prends des décisions toujours aussi bien qu'avant.", "Il m'est plus difficile que d'habitude de prendre des décisions.", "J'ai beaucoup plus de mal qu'avant à prendre des décisions.", "J'ai du mal à prendre n'importe quelle décision."]],
      ["Dévalorisation", ["Je pense être quelqu'un de valable.", "Je ne crois pas avoir autant de valeur ni être aussi utile qu'avant.", "Je me sens moins valable que les autres.", "Je sens que je ne vaux absolument rien."]],
      ["Perte d'énergie", ["J'ai toujours autant d'énergie qu'avant.", "J'ai moins d'énergie qu'avant.", "Je n'ai pas assez d'énergie pour pouvoir faire grand-chose.", "J'ai trop peu d'énergie pour faire quoi que ce soit."]],
      ["Modifications dans les habitudes de sommeil", ["Mes habitudes de sommeil n'ont pas changé.", "Je dors un peu plus que d'habitude / Je dors un peu moins que d'habitude.", "Je dors beaucoup plus que d'habitude / Je dors beaucoup moins que d'habitude.", "Je dors presque toute la journée / Je me réveille une ou deux heures plus tôt et je suis incapable de me rendormir."]],
      ["Irritabilité", ["Je ne suis pas plus irritable que d'habitude.", "Je suis plus irritable que d'habitude.", "Je suis beaucoup plus irritable que d'habitude.", "Je suis constamment irritable."]],
      ["Modifications de l'appétit", ["Mon appétit n'a pas changé.", "J'ai un peu moins d'appétit que d'habitude / J'ai un peu plus d'appétit que d'habitude.", "J'ai beaucoup moins d'appétit que d'habitude / J'ai beaucoup plus d'appétit que d'habitude.", "Je n'ai pas d'appétit du tout / J'ai constamment envie de manger."]],
      ["Difficulté à se concentrer", ["Je parviens à me concentrer toujours aussi bien qu'avant.", "Je ne parviens pas à me concentrer aussi bien que d'habitude.", "J'ai du mal à me concentrer longtemps sur quoi que ce soit.", "Je me trouve incapable de me concentrer sur quoi que ce soit."]],
      ["Fatigue", ["Je ne suis pas plus fatigué(e) que d'habitude.", "Je me fatigue plus facilement que d'habitude.", "Je suis trop fatigué(e) pour faire un grand nombre de choses.", "Je suis trop fatigué(e) pour faire la plupart des choses que je faisais avant."]],
      ["Perte d'intérêt pour le sexe", ["Je n'ai pas noté de changement dans mon intérêt pour le sexe.", "Le sexe m'intéresse moins qu'avant.", "Le sexe m'intéresse beaucoup moins maintenant.", "J'ai perdu tout intérêt pour le sexe."]]
    ];

    const container = document.getElementById('questions');
    questions.forEach(([title, options], i) => {
      const div = document.createElement('div');
      div.classList.add('question');
      div.innerHTML = `<p>${i + 1}. ${title}</p>` +
        options.map((opt, j) => `<label><input type="radio" name="q${i}" value="${j}"> ${opt}</label>`).join('');
      container.appendChild(div);
    });

    function generateCSV() {
      const identifiant = document.getElementById("identifiant").value.trim();
      if (!identifiant) {
        alert("Veuillez renseigner l'identifiant patient avant de télécharger les résultats.");
        return;
      }

      let csvContent = "Identifiant;Numéro;Question;Réponse\n";
      questions.forEach(([title, options], i) => {
        const radios = document.getElementsByName(`q${i}`);
        let selected = "Non répondu";
        radios.forEach(r => { if (r.checked) selected = r.value; });
        csvContent += `"${identifiant}";"${i + 1}";"${title}";"${selected}"\n`;
      });

      const BOM = "\uFEFF";
      const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${identifiant}_BDI-II_resultats.csv`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>
